<div class="layout">
  <!-- Menu lateral -->
  <aside class="menu-lateral">
    <div class="logo">Clinica Fácil</div>

    <div class="opcao-menu selecionado">
      {{ isMedico ? 'Minhas Consultas' : 'Agendar Consulta' }}
    </div>

    <div class="usuario-logado" *ngIf="authService.isAuthenticated(); else loginLink">
      <div>
        {{ usuarioAtual }} <br />
        <span class="tipo-usuario">
          {{ isMedico ? 'Médico' : 'Paciente' }}
        </span>
      </div>
      <br />
      <span class="logout" (click)="logout()">Sair</span>
    </div>

    <ng-template #loginLink>
      <div class="usuario-logado" (click)="irParaLogin()">
        Perfil <br />
        <span class="tipo-usuario">Clique para logar</span>
      </div>
    </ng-template>
  </aside>

  <!-- Conteúdo principal -->
  <main class="conteudo">
    <div class="cabecalho-consultas">
      <h2>{{ isMedico ? 'Minhas Consultas Agendadas' : 'Minhas Consultas' }}</h2>
      <button 
        class="botao-agendar" 
        (click)="abrirModalAgendamento()"
        [disabled]="!authService.isAuthenticated() || isMedico">
        + Nova Consulta
      </button>
    </div>

    <div *ngIf="!authService.isAuthenticated()" class="aviso-login">
      <p>Por favor, faça login para visualizar e agendar consultas.</p>
    </div>

    <div *ngIf="authService.isAuthenticated() && consultas.length === 0" class="sem-consultas">
      <p>{{ isMedico ? 'Nenhuma consulta agendada para você.' : 'Nenhuma consulta agendada.' }}</p>
    </div>

    <app-table-pagination
      *ngIf="authService.isAuthenticated() && consultas.length > 0"
      [dados]="consultas"
      [acoes]="acoes"
      [totalItens]="totalItens"
      (pageChangeEvent)="pageChanged($event)">
    </app-table-pagination>

    <!-- Modal de agendamento/reagendamento -->
    <app-modal
      *ngIf="modalAberto"
      class="modal-cadastro"
      (fecharModal)="fecharModal()"
      (submit)="confirmarAcao()"
      [tituloModal]="isCadastro ? 'Agendar Consulta' : 'Reagendar Consulta'"
      textoBotao="Confirmar">
      
      <form [formGroup]="formConsulta" class="form-cadastro">
        <app-input-primario
          class="input-padrao"
          [addLabel]="true"
          label="Paciente:"
          formControlName="patient"
          [disabled]="true">
        </app-input-primario>

        <app-input-primario
          class="input-padrao"
          [addLabel]="true"
          label="Médico:"
          formControlName="doctor"
          [disabled]="false">
        </app-input-primario>

        <app-input-primario
          class="input-padrao"
          [addLabel]="true"
          label="Data:"
          type="date"
          formControlName="date"
          [min]="today">
        </app-input-primario>

        <app-input-primario
          class="input-padrao"
          [addLabel]="true"
          label="Hora:"
          type="time"
          formControlName="time">
        </app-input-primario>
      </form>
    </app-modal>
  </main>
</div>